<!doctype html>

<html>
   <head>
      <style>
         .container {
            position: relative;
         }
         
         #text {
            position: absolute;
            left: 0px;
            top: 0px;
            z-index: 10;
         }
      </style>
   </head>
   <body>
      <div class="container">
         <canvas width = "800" height = "600" id="my_Canvas"></canvas>
         <canvas width = "800" height = "600" id="text"></canvas>
       </div>
      <!--   <canvas width = "800" height = "600" id = "my_Canvas"></canvas> !-->

      <script>
       
         const canvas = document.getElementById('my_Canvas');
         gl = canvas.getContext('experimental-webgl');

                  // look up the text canvas.
         const textCanvas = document.getElementById('text');
         
         // make a 2D context for it
         const ctx = textCanvas.getContext("2d");

         let pickaxeUpImg = new Image();
         pickaxeUpImg.src = 'pickaxeUp.png';
         pickaxeUpImg.onload = function() {
            ctx.drawImage(pickaxeUpImg, 0, 0, 800, 600);
         };

         let pickaxeDownImg = new Image();
         pickaxeDownImg.src = 'pickaxeDown.png';
       //  pickaxeDownImg.onload = function() {
           // 
      //   };


         

         let keys = {
            "w":false,
            "a":false,
            "s":false,
            "d":false
         };

         let clickOnRock = false;

         document.addEventListener('mousemove', (e) => {
               if (document.pointerLockElement === canvas) {
                  mouseX = e.movementX;
                  mouseY = e.movementY;
                  xAngle -= mouseY*0.001;
                  yAngle += mouseX*0.001;
                  if (xAngle > Math.PI*0.5) xAngle = 0.5*Math.PI;
                  if (xAngle < -Math.PI*0.5) xAngle =  -Math.PI*0.5;
               }
         });

         document.addEventListener('click', (e) => {
            canvas.requestPointerLock = canvas.requestPointerLock || 
                                     canvas.mozRequestPointerLock || 
                                     canvas.webkitRequestPointerLock;
            canvas.requestPointerLock();

            if (e.button == 0) {  
               if (facingObject([0,0,0])) {
                  clickOnRock = true;
               }
               if (facingObject(anvilPos)) {
                  upgrade();
               }
            } 
         });

         document.addEventListener('keydown', (e) => {
            if (e.key in keys) {
               keys[e.key] = true;
            }
         });

         document.addEventListener('keyup', (e) => {
            if (e.key in keys) {
               keys[e.key] = false;
            }
         });


         const vertices = [
            -1,0,-1, 1,1,1, 0,0, 1,0,-1, 1,1,1, 1000,0, 1,0,1, 1,1,1, 1000,1000, 1,0,1, 1,1,1, 1000,1000, -1,0,-1, 1,1,1, 0,0, -1,0,1, 1,1,1, 0,1000, // ground

            0.8,0.0,-0.6,   2,1.5,2.9,   0.0,0.0,      1.0,0.0,-0.6,   2,1.5,2.9,   0.1,0.0,      1.0,0.0,-0.8,   2,1.5,2.9,   0.1,0.1,
      0.8,0.0,-0.6,   2,1.5,2.9,   0.0,0.0,      1.0,0.0,-0.8,   2,1.5,2.9,   0.1,0.1,      0.8,0.0,-0.8,   2,1.5,2.9,   0.0,0.1,
      0.6,0.0,-0.8,   2,1.5,2.9,   0.0,0.0,      1.0,0.0,-0.8,   2,1.5,2.9,   0.1,0.0,      1.0,0.0,-1.0,   2,1.5,2.9,   0.1,0.1,
      0.6,0.0,-0.8,   2,1.5,2.9,   0.0,0.0,      1.0,0.0,-1.0,   2,1.5,2.9,   0.1,0.1,      0.6,0.0,-1.0,   2,1.5,2.9,   0.0,0.1,
      -0.8,0.0,-0.6,   2,1.5,2.9,   0.0,0.0,      -0.8,0.0,-1.0,   2,1.5,2.9,   0.1,0.0,      -1.0,0.0,-1.0,   2,1.5,2.9,   0.1,0.1,
      -0.8,0.0,-0.6,   2,1.5,2.9,   0.0,0.0,      -1.0,0.0,-1.0,   2,1.5,2.9,   0.1,0.1,      -1.0,0.0,-0.6,   2,1.5,2.9,   0.0,0.1,
      -0.6,0.0,-0.8,   2,1.5,2.9,   0.0,0.0,      -0.6,0.0,-1.0,   2,1.5,2.9,   0.1,0.0,      -0.8,0.0,-1.0,   2,1.5,2.9,   0.1,0.1,
      -0.6,0.0,-0.8,   2,1.5,2.9,   0.0,0.0,      -0.8,0.0,-1.0,   2,1.5,2.9,   0.1,0.1,      -0.8,0.0,-0.8,   2,1.5,2.9,   0.0,0.1,
      0.6,0.0,0.8,   2,1.5,2.9,   0.0,0.0,      0.6,0.0,1.0,   2,1.5,2.9,   0.1,0.0,      0.8,0.0,1.0,   2,1.5,2.9,   0.1,0.1,
      0.6,0.0,0.8,   2,1.5,2.9,   0.0,0.0,      0.8,0.0,1.0,   2,1.5,2.9,   0.1,0.1,      0.8,0.0,0.8,   2,1.5,2.9,   0.0,0.1,
      0.8,0.0,0.6,   2,1.5,2.9,   0.0,0.0,      0.8,0.0,1.0,   2,1.5,2.9,   0.1,0.0,      1.0,0.0,1.0,   2,1.5,2.9,   0.1,0.1,
      0.8,0.0,0.6,   2,1.5,2.9,   0.0,0.0,      1.0,0.0,1.0,   2,1.5,2.9,   0.1,0.1,      1.0,0.0,0.6,   2,1.5,2.9,   0.0,0.1,
      -0.6,0.0,0.8,   2,1.5,2.9,   0.0,0.0,      -1.0,0.0,0.8,   2,1.5,2.9,   0.1,0.0,      -1.0,0.0,1.0,   2,1.5,2.9,   0.1,0.1,
      -0.6,0.0,0.8,   2,1.5,2.9,   0.0,0.0,      -1.0,0.0,1.0,   2,1.5,2.9,   0.1,0.1,      -0.6,0.0,1.0,   2,1.5,2.9,   0.0,0.1,
      -0.8,0.0,0.6,   2,1.5,2.9,   0.0,0.0,      -1.0,0.0,0.6,   2,1.5,2.9,   0.1,0.0,      -1.0,0.0,0.8,   2,1.5,2.9,   0.1,0.1,
      -0.8,0.0,0.6,   2,1.5,2.9,   0.0,0.0,      -1.0,0.0,0.8,   2,1.5,2.9,   0.1,0.1,      -0.8,0.0,0.8,   2,1.5,2.9,   0.0,0.1,



      // anvil
            -1.0,1.5,2.0,   0.5621720433968704,0.5621720433968704,0.5621720433968704,   0.0,0.0,      -1.0,1.9,2.0,   0.5621720433968704,0.5621720433968704,0.5621720433968704,   1.0,0.0,      -1.0,1.9,-1.0,   0.5621720433968704,0.5621720433968704,0.5621720433968704,   1.0,1.0,
      -1.0,1.5,2.0,   0.5621720433968704,0.5621720433968704,0.5621720433968704,   0.0,0.0,      -1.0,1.9,-1.0,   0.5621720433968704,0.5621720433968704,0.5621720433968704,   1.0,1.0,      -1.0,1.5,-1.0,   0.5621720433968704,0.5621720433968704,0.5621720433968704,   0.0,1.0,
      -1.0,1.5,-1.0,   0.5265330025657162,0.5265330025657162,0.5265330025657162,   0.0,0.0,      -1.0,1.9,-1.0,   0.5265330025657162,0.5265330025657162,0.5265330025657162,   1.0,0.0,      1.0,1.9,-1.0,   0.5265330025657162,0.5265330025657162,0.5265330025657162,   1.0,1.0,
      -1.0,1.5,-1.0,   0.5265330025657162,0.5265330025657162,0.5265330025657162,   0.0,0.0,      1.0,1.9,-1.0,   0.5265330025657162,0.5265330025657162,0.5265330025657162,   1.0,1.0,      1.0,1.5,-1.0,   0.5265330025657162,0.5265330025657162,0.5265330025657162,   0.0,1.0,
      1.0,1.5,-1.0,   0.6826922297463008,0.6826922297463008,0.6826922297463008,   0.0,0.0,      1.0,1.9,-1.0,   0.6826922297463008,0.6826922297463008,0.6826922297463008,   1.0,0.0,      1.0,1.9,2.0,   0.6826922297463008,0.6826922297463008,0.6826922297463008,   1.0,1.0,
      1.0,1.5,-1.0,   0.6826922297463008,0.6826922297463008,0.6826922297463008,   0.0,0.0,      1.0,1.9,2.0,   0.6826922297463008,0.6826922297463008,0.6826922297463008,   1.0,1.0,      1.0,1.5,2.0,   0.6826922297463008,0.6826922297463008,0.6826922297463008,   0.0,1.0,
      1.0,1.5,2.0,   0.9504076983596278,0.9504076983596278,0.9504076983596278,   0.0,0.0,      1.0,1.9,2.0,   0.9504076983596278,0.9504076983596278,0.9504076983596278,   1.0,0.0,      -1.0,1.9,2.0,   0.9504076983596278,0.9504076983596278,0.9504076983596278,   1.0,1.0,
      1.0,1.5,2.0,   0.9504076983596278,0.9504076983596278,0.9504076983596278,   0.0,0.0,      -1.0,1.9,2.0,   0.9504076983596278,0.9504076983596278,0.9504076983596278,   1.0,1.0,      -1.0,1.5,2.0,   0.9504076983596278,0.9504076983596278,0.9504076983596278,   0.0,1.0,
      -1.0,1.5,-1.0,   0.7947597405472879,0.7947597405472879,0.7947597405472879,   0.0,0.0,      1.0,1.5,-1.0,   0.7947597405472879,0.7947597405472879,0.7947597405472879,   1.0,0.0,      1.0,1.5,2.0,   0.7947597405472879,0.7947597405472879,0.7947597405472879,   1.0,1.0,
      -1.0,1.5,-1.0,   0.7947597405472879,0.7947597405472879,0.7947597405472879,   0.0,0.0,      1.0,1.5,2.0,   0.7947597405472879,0.7947597405472879,0.7947597405472879,   1.0,1.0,      -1.0,1.5,2.0,   0.7947597405472879,0.7947597405472879,0.7947597405472879,   0.0,1.0,
      1.0,1.9,-1.0,   0.8642506237225718,0.8642506237225718,0.8642506237225718,   0.0,0.0,      -1.0,1.9,-1.0,   0.8642506237225718,0.8642506237225718,0.8642506237225718,   1.0,0.0,      -1.0,1.9,2.0,   0.8642506237225718,0.8642506237225718,0.8642506237225718,   1.0,1.0,
      1.0,1.9,-1.0,   0.8642506237225718,0.8642506237225718,0.8642506237225718,   0.0,0.0,      -1.0,1.9,2.0,   0.8642506237225718,0.8642506237225718,0.8642506237225718,   1.0,1.0,      1.0,1.9,2.0,   0.8642506237225718,0.8642506237225718,0.8642506237225718,   0.0,1.0,
      0.0,1.0,-1.0,   0.7250738343996334,0.7250738343996334,0.7250738343996334,   0.0,0.0,      -0.5,1.75,-1.0,   0.7250738343996334,0.7250738343996334,0.7250738343996334,   1.0,0.0,      0.0,1.75,-3.0,   0.7250738343996334,0.7250738343996334,0.7250738343996334,   1.0,1.0,
      0.0,1.75,-3.0,   0.6524172641931685,0.6524172641931685,0.6524172641931685,   0.0,0.0,      0.5,1.75,-1.0,   0.6524172641931685,0.6524172641931685,0.6524172641931685,   1.0,0.0,      0.0,1.0,-1.0,   0.6524172641931685,0.6524172641931685,0.6524172641931685,   1.0,1.0,
      0.0,1.0,-1.0,   0.8806312982952693,0.8806312982952693,0.8806312982952693,   0.0,0.0,      0.5,1.75,-1.0,   0.8806312982952693,0.8806312982952693,0.8806312982952693,   1.0,0.0,      -0.5,1.75,-1.0,   0.8806312982952693,0.8806312982952693,0.8806312982952693,   1.0,1.0,
      0.0,1.75,-3.0,   0.6632525191253568,0.6632525191253568,0.6632525191253568,   0.0,0.0,      -0.5,1.75,-1.0,   0.6632525191253568,0.6632525191253568,0.6632525191253568,   1.0,0.0,      0.5,1.75,-1.0,   0.6632525191253568,0.6632525191253568,0.6632525191253568,   1.0,1.0,
      -0.5,1.0,1.0,   0.7989391264989222,0.7989391264989222,0.7989391264989222,   0.375,0.25,      -0.5,1.75,2.0,   0.7989391264989222,0.7989391264989222,0.7989391264989222,   0.625,0.0,      -0.5,1.75,1.0,   0.7989391264989222,0.7989391264989222,0.7989391264989222,   0.625,0.25,      
      -0.5,1.0,1.0,   0.7594351423893562,0.7594351423893562,0.7594351423893562,   0.375,0.25,      -0.5,1.75,1.0,   0.7594351423893562,0.7594351423893562,0.7594351423893562,   0.625,0.25,      0.5,1.75,1.0,   0.7594351423893562,0.7594351423893562,0.7594351423893562,   0.625,0.5,       
      -0.5,1.0,1.0,   0.7594351423893562,0.7594351423893562,0.7594351423893562,   0.375,0.25,      0.5,1.75,1.0,   0.7594351423893562,0.7594351423893562,0.7594351423893562,   0.625,0.5,      0.5,1.0,1.0,   0.7594351423893562,0.7594351423893562,0.7594351423893562,   0.375,0.5,
      0.5,1.0,1.0,   0.6230927751329505,0.6230927751329505,0.6230927751329505,   0.375,0.5,      0.5,1.75,1.0,   0.6230927751329505,0.6230927751329505,0.6230927751329505,   0.625,0.5,      0.5,1.75,2.0,   0.6230927751329505,0.6230927751329505,0.6230927751329505,   0.625,0.75,
      0.5,1.75,1.0,   0.9157713554790228,0.9157713554790228,0.9157713554790228,   0.625,0.5,      -0.5,1.75,1.0,   0.9157713554790228,0.9157713554790228,0.9157713554790228,   0.875,0.5,      -0.5,1.75,2.0,   0.9157713554790228,0.9157713554790228,0.9157713554790228,   0.875,0.75,       
      0.5,1.75,1.0,   0.9157713554790228,0.9157713554790228,0.9157713554790228,   0.625,0.5,      -0.5,1.75,2.0,   0.9157713554790228,0.9157713554790228,0.9157713554790228,   0.875,0.75,      0.5,1.75,2.0,   0.9157713554790228,0.9157713554790228,0.9157713554790228,   0.625,0.75,       
      -0.5,1.0,1.0,   0.9251002755049116,0.9251002755049116,0.9251002755049116,   0.125,0.5,      0.5,1.0,1.0,   0.9251002755049116,0.9251002755049116,0.9251002755049116,   0.375,0.5,      0.5,1.75,2.0,   0.9251002755049116,0.9251002755049116,0.9251002755049116,   0.625,0.75,
      -0.5,1.0,1.0,   0.9251002755049116,0.9251002755049116,0.9251002755049116,   0.125,0.5,      0.5,1.75,2.0,   0.9251002755049116,0.9251002755049116,0.9251002755049116,   0.625,0.75,      -0.5,1.75,2.0,   0.9251002755049116,0.9251002755049116,0.9251002755049116,   0.625,1.0,        
      -0.5,1.0,1.0,   0.5926069564721672,0.5926069564721672,0.5926069564721672,   0.0,0.0,      -0.5,1.75,1.0,   0.5926069564721672,0.5926069564721672,0.5926069564721672,   1.0,0.0,      -0.5,1.75,-1.0,   0.5926069564721672,0.5926069564721672,0.5926069564721672,   1.0,1.0,
      -0.5,1.0,1.0,   0.5926069564721672,0.5926069564721672,0.5926069564721672,   0.0,0.0,      -0.5,1.75,-1.0,   0.5926069564721672,0.5926069564721672,0.5926069564721672,   1.0,1.0,      -0.5,1.0,-1.0,   0.5926069564721672,0.5926069564721672,0.5926069564721672,   0.0,1.0,
      -0.5,1.0,-1.0,   0.8611489490566211,0.8611489490566211,0.8611489490566211,   0.0,0.0,      -0.5,1.75,-1.0,   0.8611489490566211,0.8611489490566211,0.8611489490566211,   1.0,0.0,      0.5,1.75,-1.0,   0.8611489490566211,0.8611489490566211,0.8611489490566211,   1.0,1.0,
      -0.5,1.0,-1.0,   0.8611489490566211,0.8611489490566211,0.8611489490566211,   0.0,0.0,      0.5,1.75,-1.0,   0.8611489490566211,0.8611489490566211,0.8611489490566211,   1.0,1.0,      0.5,1.0,-1.0,   0.8611489490566211,0.8611489490566211,0.8611489490566211,   0.0,1.0,
      0.5,1.0,-1.0,   0.5113352372385673,0.5113352372385673,0.5113352372385673,   0.0,0.0,      0.5,1.75,-1.0,   0.5113352372385673,0.5113352372385673,0.5113352372385673,   1.0,0.0,      0.5,1.75,1.0,   0.5113352372385673,0.5113352372385673,0.5113352372385673,   1.0,1.0,
      0.5,1.0,-1.0,   0.5113352372385673,0.5113352372385673,0.5113352372385673,   0.0,0.0,      0.5,1.75,1.0,   0.5113352372385673,0.5113352372385673,0.5113352372385673,   1.0,1.0,      0.5,1.0,1.0,   0.5113352372385673,0.5113352372385673,0.5113352372385673,   0.0,1.0,
      0.5,1.0,1.0,   0.9474162400219031,0.9474162400219031,0.9474162400219031,   0.0,0.0,      0.5,1.75,1.0,   0.9474162400219031,0.9474162400219031,0.9474162400219031,   1.0,0.0,      -0.5,1.75,1.0,   0.9474162400219031,0.9474162400219031,0.9474162400219031,   1.0,1.0,
      0.5,1.0,1.0,   0.9474162400219031,0.9474162400219031,0.9474162400219031,   0.0,0.0,      -0.5,1.75,1.0,   0.9474162400219031,0.9474162400219031,0.9474162400219031,   1.0,1.0,      -0.5,1.0,1.0,   0.9474162400219031,0.9474162400219031,0.9474162400219031,   0.0,1.0,
      -0.5,1.0,-1.0,   0.9231444699088964,0.9231444699088964,0.9231444699088964,   0.0,0.0,      0.5,1.0,-1.0,   0.9231444699088964,0.9231444699088964,0.9231444699088964,   1.0,0.0,      0.5,1.0,1.0,   0.9231444699088964,0.9231444699088964,0.9231444699088964,   1.0,1.0,
      -0.5,1.0,-1.0,   0.9231444699088964,0.9231444699088964,0.9231444699088964,   0.0,0.0,      0.5,1.0,1.0,   0.9231444699088964,0.9231444699088964,0.9231444699088964,   1.0,1.0,      -0.5,1.0,1.0,   0.9231444699088964,0.9231444699088964,0.9231444699088964,   0.0,1.0,
      0.5,1.75,-1.0,   0.9787412457876343,0.9787412457876343,0.9787412457876343,   0.0,0.0,      -0.5,1.75,-1.0,   0.9787412457876343,0.9787412457876343,0.9787412457876343,   1.0,0.0,      -0.5,1.75,1.0,   0.9787412457876343,0.9787412457876343,0.9787412457876343,   1.0,1.0,
      0.5,1.75,-1.0,   0.9787412457876343,0.9787412457876343,0.9787412457876343,   0.0,0.0,      -0.5,1.75,1.0,   0.9787412457876343,0.9787412457876343,0.9787412457876343,   1.0,1.0,      0.5,1.75,1.0,   0.9787412457876343,0.9787412457876343,0.9787412457876343,   0.0,1.0,
      -0.75,-0.0,1.5,   0.7598565553688044,0.7598565553688044,0.7598565553688044,   0.0,0.0,      -0.5,1.0,1.0,   0.7598565553688044,0.7598565553688044,0.7598565553688044,   1.0,0.0,      -0.5,1.0,-1.0,   0.7598565553688044,0.7598565553688044,0.7598565553688044,   1.0,1.0,
      -0.75,-0.0,1.5,   0.7598565553688044,0.7598565553688044,0.7598565553688044,   0.0,0.0,      -0.5,1.0,-1.0,   0.7598565553688044,0.7598565553688044,0.7598565553688044,   1.0,1.0,      -0.75,-0.0,-1.5,   0.7598565553688044,0.7598565553688044,0.7598565553688044,   0.0,1.0,
      -0.75,-0.0,-1.5,   0.9416015920450809,0.9416015920450809,0.9416015920450809,   0.0,0.0,      -0.5,1.0,-1.0,   0.9416015920450809,0.9416015920450809,0.9416015920450809,   1.0,0.0,      0.5,1.0,-1.0,   0.9416015920450809,0.9416015920450809,0.9416015920450809,   1.0,1.0,
      -0.75,-0.0,-1.5,   0.9416015920450809,0.9416015920450809,0.9416015920450809,   0.0,0.0,      0.5,1.0,-1.0,   0.9416015920450809,0.9416015920450809,0.9416015920450809,   1.0,1.0,      0.75,-0.0,-1.5,   0.9416015920450809,0.9416015920450809,0.9416015920450809,   0.0,1.0,
      0.75,-0.0,-1.5,   0.5432557874464079,0.5432557874464079,0.5432557874464079,   0.0,0.0,      0.5,1.0,-1.0,   0.5432557874464079,0.5432557874464079,0.5432557874464079,   1.0,0.0,      0.5,1.0,1.0,   0.5432557874464079,0.5432557874464079,0.5432557874464079,   1.0,1.0,
      0.75,-0.0,-1.5,   0.5432557874464079,0.5432557874464079,0.5432557874464079,   0.0,0.0,      0.5,1.0,1.0,   0.5432557874464079,0.5432557874464079,0.5432557874464079,   1.0,1.0,      0.75,-0.0,1.5,   0.5432557874464079,0.5432557874464079,0.5432557874464079,   0.0,1.0,
      0.75,-0.0,1.5,   0.8360157147613481,0.8360157147613481,0.8360157147613481,   0.0,0.0,      0.5,1.0,1.0,   0.8360157147613481,0.8360157147613481,0.8360157147613481,   1.0,0.0,      -0.5,1.0,1.0,   0.8360157147613481,0.8360157147613481,0.8360157147613481,   1.0,1.0,
      0.75,-0.0,1.5,   0.8360157147613481,0.8360157147613481,0.8360157147613481,   0.0,0.0,      -0.5,1.0,1.0,   0.8360157147613481,0.8360157147613481,0.8360157147613481,   1.0,1.0,      -0.75,-0.0,1.5,   0.8360157147613481,0.8360157147613481,0.8360157147613481,   0.0,1.0,
      -0.75,-0.0,-1.5,   0.7563110698253479,0.7563110698253479,0.7563110698253479,   0.0,0.0,      0.75,-0.0,-1.5,   0.7563110698253479,0.7563110698253479,0.7563110698253479,   1.0,0.0,      0.75,-0.0,1.5,   0.7563110698253479,0.7563110698253479,0.7563110698253479,   1.0,1.0,
      -0.75,-0.0,-1.5,   0.7563110698253479,0.7563110698253479,0.7563110698253479,   0.0,0.0,      0.75,-0.0,1.5,   0.7563110698253479,0.7563110698253479,0.7563110698253479,   1.0,1.0,      -0.75,-0.0,1.5,   0.7563110698253479,0.7563110698253479,0.7563110698253479,   0.0,1.0,
      0.5,1.0,-1.0,   0.8337347851887921,0.8337347851887921,0.8337347851887921,   0.0,0.0,      -0.5,1.0,-1.0,   0.8337347851887921,0.8337347851887921,0.8337347851887921,   1.0,0.0,      -0.5,1.0,1.0,   0.8337347851887921,0.8337347851887921,0.8337347851887921,   1.0,1.0,
      0.5,1.0,-1.0,   0.8337347851887921,0.8337347851887921,0.8337347851887921,   0.0,0.0,      -0.5,1.0,1.0,   0.8337347851887921,0.8337347851887921,0.8337347851887921,   1.0,1.0,      0.5,1.0,1.0,   0.8337347851887921,0.8337347851887921,0.8337347851887921,   0.0,1.0,


         //rock
            0.755188,0.0,0.236577,   0.989922235513761,0.989922235513761,0.989922235513761,   0.5,1.0,      0.629863,0.408184,0.003875,   0.989922235513761,0.989922235513761,0.989922235513761,   0.933013,0.75,      0.420653,0.681836,0.050294,   0.989922235513761,0.989922235513761,0.989922235513761,   0.933013,0.25,
      0.755188,0.0,0.236577,   0.989922235513761,0.989922235513761,0.989922235513761,   0.5,1.0,      0.420653,0.681836,0.050294,   0.989922235513761,0.989922235513761,0.989922235513761,   0.933013,0.25,      0.135188,0.692275,0.387458,   0.989922235513761,0.989922235513761,0.989922235513761,   0.5,0.0,
      0.755188,0.0,0.236577,   0.989922235513761,0.989922235513761,0.989922235513761,   0.5,1.0,      0.135188,0.692275,0.387458,   0.989922235513761,0.989922235513761,0.989922235513761,   0.5,0.0,      0.206469,0.404311,0.603985,   0.989922235513761,0.989922235513761,0.989922235513761,   0.066987,0.25,
      0.755188,0.0,0.236577,   0.989922235513761,0.989922235513761,0.989922235513761,   0.5,1.0,      0.206469,0.404311,0.603985,   0.989922235513761,0.989922235513761,0.989922235513761,   0.066987,0.25,      0.477912,0.0,0.615121,   0.989922235513761,0.989922235513761,0.989922235513761,   0.066987,0.75,
      -0.008878,0.0,0.769289,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.5,1.0,      0.206469,0.404311,0.603985,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.933013,0.75,      0.135188,0.692275,0.387458,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.933013,0.25,
      -0.008878,0.0,0.769289,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.5,1.0,      0.135188,0.692275,0.387458,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.933013,0.25,      -0.326837,0.664954,0.23496,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.5,0.0,
      -0.008878,0.0,0.769289,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.5,1.0,      -0.326837,0.664954,0.23496,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.5,0.0,      -0.545876,0.338237,0.379919,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.066987,0.25,
      -0.008878,0.0,0.769289,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.5,1.0,      -0.545876,0.338237,0.379919,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.066987,0.25,      -0.464426,0.0,0.612229,   0.6511054327692787,0.6511054327692787,0.6511054327692787,   0.066987,0.75,
      -0.762037,0.0,0.230385,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.5,1.0,      -0.545876,0.338237,0.379919,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.933013,0.75,      -0.326837,0.664954,0.23496,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.933013,0.25,
      -0.762037,0.0,0.230385,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.5,1.0,      -0.326837,0.664954,0.23496,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.933013,0.25,      -0.364764,0.628334,-0.320401,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.5,0.0,
      -0.762037,0.0,0.230385,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.5,1.0,      -0.364764,0.628334,-0.320401,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.5,0.0,      -0.530555,0.320168,-0.517115,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.066987,0.25,
      -0.762037,0.0,0.230385,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.5,1.0,      -0.530555,0.320168,-0.517115,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.066987,0.25,      -0.753934,0.0,-0.231005,   0.5279500953764793,0.5279500953764793,0.5279500953764793,   0.066987,0.75,
      -0.420552,0.0,-0.731639,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.5,1.0,      -0.530555,0.320168,-0.517115,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.933013,0.75,      -0.364764,0.628334,-0.320401,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.933013,0.25,
      -0.420552,0.0,-0.731639,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.5,1.0,      -0.364764,0.628334,-0.320401,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.933013,0.25,      0.123553,0.641804,-0.402484,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.5,0.0,
      -0.420552,0.0,-0.731639,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.5,1.0,      0.123553,0.641804,-0.402484,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.5,0.0,      0.21977,0.331538,-0.651207,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.066987,0.25,
      -0.420552,0.0,-0.731639,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.5,1.0,      0.21977,0.331538,-0.651207,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.066987,0.25,      0.008934,0.0,-0.866486,   0.7486210389011219,0.7486210389011219,0.7486210389011219,   0.066987,0.75,
      0.493267,0.0,-0.675932,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.5,1.0,      0.21977,0.331538,-0.651207,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.933013,0.75,      0.123553,0.641804,-0.402484,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.933013,0.25,
      0.493267,0.0,-0.675932,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.5,1.0,      0.123553,0.641804,-0.402484,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.933013,0.25,      0.420653,0.681836,0.050294,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.5,0.0,
      0.493267,0.0,-0.675932,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.5,1.0,      0.420653,0.681836,0.050294,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.5,0.0,      0.629863,0.408184,0.003875,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.066987,0.25,
      0.493267,0.0,-0.675932,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.5,1.0,      0.629863,0.408184,0.003875,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.066987,0.25,      0.771159,0.0,-0.246798,   0.7242142896493419,0.7242142896493419,0.7242142896493419,   0.066987,0.75,
      0.135188,0.692275,0.387458,   0.5329709538931806,0.5329709538931806,0.5329709538931806,   0.5,1.0,      0.420653,0.681836,0.050294,   0.5329709538931806,0.5329709538931806,0.5329709538931806,   0.975528,0.654508,      0.123553,0.641804,-0.402484,   0.5329709538931806,0.5329709538931806,0.5329709538931806,   0.793893,0.095491,
      0.135188,0.692275,0.387458,   0.5329709538931806,0.5329709538931806,0.5329709538931806,   0.5,1.0,      0.123553,0.641804,-0.402484,   0.5329709538931806,0.5329709538931806,0.5329709538931806,   0.793893,0.095491,      -0.364764,0.628334,-0.320401,   0.5329709538931806,0.5329709538931806,0.5329709538931806,   0.206107,0.095492,
      0.135188,0.692275,0.387458,   0.5329709538931806,0.5329709538931806,0.5329709538931806,   0.5,1.0,      -0.364764,0.628334,-0.320401,   0.5329709538931806,0.5329709538931806,0.5329709538931806,   0.206107,0.095492,      -0.326837,0.664954,0.23496,   0.5329709538931806,0.5329709538931806,0.5329709538931806,   0.024472,0.654509,
      0.493267,0.0,-0.675932,   0.6889379953779802,0.6889379953779802,0.6889379953779802,   0.0,0.0,      0.008934,0.0,-0.866486,   0.6889379953779802,0.6889379953779802,0.6889379953779802,   1.0,0.0,      0.21977,0.331538,-0.651207,   0.6889379953779802,0.6889379953779802,0.6889379953779802,   1.0,1.0,
      -0.420552,0.0,-0.731639,   0.8188417314322127,0.8188417314322127,0.8188417314322127,   0.0,0.0,      -0.753934,0.0,-0.231005,   0.8188417314322127,0.8188417314322127,0.8188417314322127,   1.0,0.0,      -0.530555,0.320168,-0.517115,   0.8188417314322127,0.8188417314322127,0.8188417314322127,   1.0,1.0,
      -0.762037,0.0,0.230385,   0.7416061113093719,0.7416061113093719,0.7416061113093719,   0.0,0.0,      -0.464426,0.0,0.612229,   0.7416061113093719,0.7416061113093719,0.7416061113093719,   1.0,0.0,      -0.545876,0.338237,0.379919,   0.7416061113093719,0.7416061113093719,0.7416061113093719,   1.0,1.0,
      -0.008878,0.0,0.769289,   0.7679721707673244,0.7679721707673244,0.7679721707673244,   0.0,0.0,      0.477912,0.0,0.615121,   0.7679721707673244,0.7679721707673244,0.7679721707673244,   1.0,0.0,      0.206469,0.404311,0.603985,   0.7679721707673244,0.7679721707673244,0.7679721707673244,   1.0,1.0,
      0.755188,0.0,0.236577,   0.92563632608978,0.92563632608978,0.92563632608978,   0.0,0.0,      0.771159,0.0,-0.246798,   0.92563632608978,0.92563632608978,0.92563632608978,   1.0,0.0,      0.629863,0.408184,0.003875,   0.92563632608978,0.92563632608978,0.92563632608978,   1.0,1.0,



   ];
       


const texture = gl.createTexture();
let img = new Image();

img.crossOrigin = '';
img.src = "textures/stone_texture.png";

img.onload = function() {

   gl.activeTexture(gl.TEXTURE0);

   gl.bindTexture(gl.TEXTURE_2D, texture);
   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);
   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);
   gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, img);
   gl.generateMipmap(gl.TEXTURE_2D);

};


const texture2 = gl.createTexture();
let img2 = new Image();

img2.crossOrigin = '';
img2.src = "textures/grass.png";

img2.onload = function() {

gl.activeTexture(gl.TEXTURE0);

  gl.bindTexture(gl.TEXTURE_2D, texture2);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);
  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, img2);
  gl.generateMipmap(gl.TEXTURE_2D);

};


const texture3 = gl.createTexture();
let img3 = new Image();

img3.crossOrigin = '';
img3.src = "textures/anvil.png";

img3.onload = function() {

gl.activeTexture(gl.TEXTURE0);

  gl.bindTexture(gl.TEXTURE_2D, texture3);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);
  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, img3);
  gl.generateMipmap(gl.TEXTURE_2D);

};




         const vertex_buffer = gl.createBuffer();


         gl.bindBuffer(gl.ARRAY_BUFFER, vertex_buffer);
         
  
         gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);


         gl.bindBuffer(gl.ARRAY_BUFFER, null);

         const vertCode =
            'attribute vec3 coordinates;' +
            'attribute vec3 aColor;' +
            'attribute vec2 aTexture;' +
            'varying vec3 vColor;' +
            'varying vec2 vTexture;' +
            'uniform mat4 projection;'+
            'uniform mat4 view;'+
            'uniform mat4 model;'+
            'void main() {' +
               ' vColor = aColor;'+
               ' vTexture = aTexture;'+
               ' gl_Position = projection*view*model*vec4(coordinates, 1.0);' +
            '}';
            
 
         const vertShader = gl.createShader(gl.VERTEX_SHADER);

         gl.shaderSource(vertShader, vertCode);


         gl.compileShader(vertShader);


         const fragCode = 'precision mediump float;' +
            'uniform sampler2D uSampler;' +
            'varying vec3 vColor;' +
            'varying vec2 vTexture;' +
            'void main() {' +
             //  ' gl_FragColor = texture2D(uSampler, vTexture);' +
              'gl_FragColor = texture2D(uSampler, vTexture)*vec4(vColor, 1.0);' +
            '}';
            

         const fragShader = gl.createShader(gl.FRAGMENT_SHADER);


         gl.shaderSource(fragShader, fragCode); 
         

         gl.compileShader(fragShader);


         const shaderProgram = gl.createProgram();


         gl.attachShader(shaderProgram, vertShader);

         gl.attachShader(shaderProgram, fragShader);


         gl.linkProgram(shaderProgram);







         gl.useProgram(shaderProgram);

         const pLoc = gl.getUniformLocation(shaderProgram, "projection");
         const vLoc = gl.getUniformLocation(shaderProgram, "view");
         const mLoc = gl.getUniformLocation(shaderProgram, "model");

         const uSamplerPos = gl.getUniformLocation(shaderProgram, "uSampler");
         gl.uniform1i(uSamplerPos, 0);


         gl.bindBuffer(gl.ARRAY_BUFFER, vertex_buffer);


         

         const coordPos = gl.getAttribLocation(shaderProgram, "coordinates");


         gl.vertexAttribPointer(coordPos, 3, gl.FLOAT, false, 8 * Float32Array.BYTES_PER_ELEMENT, 0); 
         

         gl.enableVertexAttribArray(coordPos);

         const colorPos = gl.getAttribLocation(shaderProgram, "aColor");


         gl.vertexAttribPointer(colorPos, 3, gl.FLOAT, false, 8 * Float32Array.BYTES_PER_ELEMENT, 3 * Float32Array.BYTES_PER_ELEMENT); 
         

         gl.enableVertexAttribArray(colorPos);


         const texturePos = gl.getAttribLocation(shaderProgram, "aTexture");


         gl.vertexAttribPointer(texturePos, 2, gl.FLOAT, false, 8 * Float32Array.BYTES_PER_ELEMENT, 6 * Float32Array.BYTES_PER_ELEMENT); 
         

         gl.enableVertexAttribArray(texturePos);

       

         let ang = Math.tan((40*0.5)*Math.PI/180);
         let projMatrix = [0.5/ang, 0 , 0, 0,
                           0, 0.5*(canvas.width/canvas.height)/ang, 0, 0,
                           0, 0, -(1000+1)/(1000-1), -1,
                           0, 0, (-2*1000*1)/(1000-1), 0 
                        ];
         let viewMatrix = [1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1];
         let modelMatrix = [1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1];



         function rotateZ(m, angle) {
            let c = Math.cos(angle);
            let s = Math.sin(angle);
            let mv0 = m[0], mv4 = m[4], mv8 = m[8];

            m[0] = c*m[0]-s*m[1];
            m[4] = c*m[4]-s*m[5];
            m[8] = c*m[8]-s*m[9];

            m[1]=c*m[1]+s*mv0;
            m[5]=c*m[5]+s*mv4;
            m[9]=c*m[9]+s*mv8;
         }

         function rotateY(m, angle) {
            let c = Math.cos(angle);
            let s = Math.sin(angle);
            let mv1 = m[1], mv5 = m[5], mv9 = m[9];

            m[1] = m[1]*c-m[2]*s;
            m[5] = m[5]*c-m[6]*s;
            m[9] = m[9]*c-m[10]*s;

            m[2] = m[2]*c+mv1*s;
            m[6] = m[6]*c+mv5*s;
            m[10] = m[10]*c+mv9*s;
         }

         function rotateX(m, angle) {
            let c = Math.cos(angle);
            let s = Math.sin(angle);
            let mv0 = m[0], mv4 = m[4], mv8 = m[8];

            m[0] = c*m[0]+s*m[2];
            m[4] = c*m[4]+s*m[6];
            m[8] = c*m[8]+s*m[10];

            m[2] = c*m[2]-s*mv0;
            m[6] = c*m[6]-s*mv4;
            m[10] = c*m[10]-s*mv8;
         }

         function lookAt(eye, front) {
            const up = [0, 1, 0];
            const frontNorm = normalize(front);
            const right = normalize(crossProduct(up, frontNorm));           
            const upNorm = normalize(crossProduct(frontNorm, right));

            return [
               right[0], upNorm[0], -frontNorm[0], 0,
               right[1], upNorm[1], -frontNorm[1], 0,
               right[2], upNorm[2], -frontNorm[2], 0,
               -dotProduct(right, eye), -dotProduct(upNorm, eye), dotProduct(frontNorm, eye), 1
            ];
         }


         function normalize(v) {
            const length = Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);
            return [v[0] / length, v[1] / length, v[2] / length];
         }

         function crossProduct(a, b) {
            return [
               a[1] * b[2] - a[2] * b[1],
               a[2] * b[0] - a[0] * b[2],
               a[0] * b[1] - a[1] * b[0]
            ];
         }

         function dotProduct(a, b) {
            return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
         }

         function difference(a, b) {
            return [a[0] - b[0], a[1] - b[1], a[2] - b[2]]
         }

         function scaleVector(a, b) {
            return [a * b[0], a * b[1], a * b[2]];
         }

         function addVector(a, b) {
            return [a[0] + b[0], a[1] + b[1], a[2] + b[2]];
         }

         function distance(a, b) {
            let diff = difference(a, b);
            return Math.sqrt(diff[0]**2 + diff[1]**2 + diff[2]**2);
         }

         function facingObject(objectPos) {
            let pos = cameraPos;
            for (let i = 0; i < 5; i++) {
               pos = addVector(pos, front);
               if (distance(pos, objectPos) <= 10 && pos[1] > -1) return true;
            }
            return false;
         }

         function clickRock() {
            cash += (upgrades + 1) * currentPickaxe.quality;
         }

         function upgrade() {
            if (cash >= upgradeCost) {
               upgrades += 1;
               cash -= upgradeCost;
               upgradeCost += 10
            }
         }

         class Pickaxe {
            constructor(speed, quality) {
               this.speed = speed;
               this.quality = quality;
            }
         }


         gl.viewport(0,0,canvas.width,canvas.height);


         let cameraPos = [0, 10, 15];
         let front = [0, 0, -1]     
         let xAngle = 0;             
         let yAngle = Math.PI;
         let speed = 1;

         let cash = 0;
         let upgrades = 0;

         let upgradeCost = 10;

         ctx.font = "50px Arial";

         let anvilPos = [50,0,20];
         let dropPos = [-60, 0, 40]

         let currentPickaxe = new Pickaxe(15, 1);
         let pickaxeDelay = 0;

         function gameloop() {
            cosa = Math.cos(yAngle);
            sina = Math.sin(yAngle);
            front = [Math.cos(xAngle) * sina, Math.sin(xAngle), Math.cos(xAngle) * cosa]

            prevPos = [...cameraPos];
            if (keys["w"]) {
               cameraPos[0] += sina * speed;
               cameraPos[2] += cosa * speed;
            }
            if (keys["a"]) {
               cameraPos[0] -= cosa * speed;
               cameraPos[2] += sina * speed;
            }
            if (keys["s"]) {
               cameraPos[0] -= sina * speed;
               cameraPos[2] -= cosa * speed;
            }
            if (keys["d"]) {
               cameraPos[0] += cosa * speed;
               cameraPos[2] -= sina * speed;
            }

            if (distance(cameraPos, [0, cameraPos[1], 0]) <= 9 || distance(cameraPos, [anvilPos[0], cameraPos[1], anvilPos[2]]) <= 9) {
               cameraPos = [...prevPos];
            }

            


            ctx.clearRect(0, 0, textCanvas.width, textCanvas.height);

            if (facingObject(anvilPos)) {
               ctx.fillText("Upgrade Cost: "+ upgradeCost, 10,100);
            }

            ctx.fillText("$ " + cash, 10,50);

            ctx.fillText("x", 400,300)

            if (clickOnRock && pickaxeDelay == 0) {
               pickaxeDelay = currentPickaxe.speed;
               clickRock();
            }

            if (pickaxeDelay > Math.round(currentPickaxe.speed / 3)) {
               ctx.drawImage(pickaxeDownImg, 0, 0, 800, 600);
            }
            else {
               ctx.drawImage(pickaxeUpImg, 0, 0, 800, 600);
            }

            if (pickaxeDelay > 0) {
               pickaxeDelay--;
            }
            clickOnRock = false;



            gl.clearColor(0.57, 0.79, 0.98, 1.0);

            gl.enable(gl.DEPTH_TEST);


            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
            
            viewMatrix = lookAt(cameraPos, front);






            gl.bindTexture(gl.TEXTURE_2D, texture2);



            modelMatrix = [10000,0,0,0, 0,10000,0,0, 0,0,10000,0, 0,0,0,1];
            gl.uniformMatrix4fv(pLoc, false, projMatrix);
            gl.uniformMatrix4fv(vLoc, false, viewMatrix);
            gl.uniformMatrix4fv(mLoc, false, modelMatrix);

            gl.drawArrays(gl.TRIANGLES, 0, 6);



            modelMatrix = [10,0,0,0, 0,10,0,0, 0,0,10,0, dropPos[0],0.1,dropPos[2],1];
            gl.uniformMatrix4fv(mLoc, false, modelMatrix);

            gl.drawArrays(gl.TRIANGLES, 6, 48);




            gl.bindTexture(gl.TEXTURE_2D, texture3);
            modelMatrix = [3,0,0,0, 0,3,0,0, 0,0,3,0, anvilPos[0],0,anvilPos[2],1];
            gl.uniformMatrix4fv(mLoc, false, modelMatrix);

            gl.drawArrays(gl.TRIANGLES, 54, 144);

            
            gl.bindTexture(gl.TEXTURE_2D, texture);
            modelMatrix = [10,0,0,0, 0,10,0,0, 0,0,10,0, 0,0,0,1];
            gl.uniformMatrix4fv(mLoc, false, modelMatrix);

            gl.drawArrays(gl.TRIANGLES, 198, 84);
         }

         setInterval(gameloop, 1000 / 30);
      </script>
    </body>
</html>